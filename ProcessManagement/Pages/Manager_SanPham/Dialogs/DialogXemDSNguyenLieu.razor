@using ProcessManagement.Commons
@using ProcessManagement.Services.SQLServer
@using Radzen.Blazor
@using Radzen
@using ProcessManagement.Models

@inject DialogService DialogService
@inject NotificationService NotificationService
@inject SQLServerServices SQLServerServices

<RadzenCard Variant="Variant.Filled" Style="height: 100%; width: 100%; background-color: white; border-radius: 0px">
    <RadzenStack Gap="10px" Orientation="Orientation.Vertical" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Style="height: 100%; width: 100%;">
        <RadzenStack Orientation="Orientation.Horizontal" Gap="10px" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Style="height: 5%; width: 100%;">
            <RadzenText Text="@($"Danh sách nguyên liệu sản phẩm")" Style="font-size: 18px; font-weight: 500; color: black"></RadzenText>
            <RadzenText Text="@($"{Sanpham?.MaSP.Value?.ToString()}")" Style="font-size: 18px; font-weight: 600; color: darkblue"></RadzenText>
        </RadzenStack>

        <RadzenCard Variant="Variant.Outlined" Style="height: 75%; width: 100%; background-color: white; border-radius: 5px;">
            <RadzenStack Style="height: 100%; width: 100%; overflow-y: scroll" Gap="10px" Orientation="Orientation.Vertical" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Start">
                @if (DSNguyenlieus != null)
                {
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Style="background-color: rgba(58, 71, 77); padding-top: 10px; padding-bottom: 10px; height: contain; width: 100%; border-bottom: var(--rz-grid-cell-border);">
                        <RadzenStack Style="width: 5%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                            <RadzenText Text="STT" Style="font-size: 16px; color: white; font-weight: 500;"></RadzenText>
                        </RadzenStack>
                        <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                            <RadzenText Text="@Common.LotNVL" Style="font-size: 16px; color: white; font-weight: 500;"></RadzenText>
                        </RadzenStack>
                        <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                            <RadzenText Text="@Common.MaSP" Style="font-size: 16px; color: white; font-weight: 500;"></RadzenText>
                        </RadzenStack>
                        <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                            <RadzenText Text="@Common.LoaiNL" Style="font-size: 16px; color: white; font-weight: 500;"></RadzenText>
                        </RadzenStack>
                        <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                            <RadzenText Text="@Common.SoLuongNVL" Style="font-size: 16px; color: white; font-weight: 500;"></RadzenText>
                        </RadzenStack>
                        <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                            <RadzenText Text="@Common.NgayNhap" Style="font-size: 16px; color: white; font-weight: 500;"></RadzenText>
                        </RadzenStack>
                    </RadzenStack>
                    @foreach (var nvl in DSNguyenlieus)
                    {
                        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Style="height: contain; width: 100%; border-bottom: var(--rz-grid-cell-border);">
                            <RadzenStack Style="width: 5%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                                <RadzenText Text="@((DSNguyenlieus.IndexOf(nvl) + 1).ToString())" Style="color: darkgray; font-size: 12px; font-weight: 500;"></RadzenText>
                            </RadzenStack>
                            <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                                <RadzenText Text="@nvl.LotNVL.Value?.ToString()" Style="font-size: 16px; font-weight: 600; color: darkblue"></RadzenText>
                            </RadzenStack>
                            <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                                <RadzenText Text="@nvl.MaSP.Value?.ToString()" Style="font-size: 16px; font-weight: 600; color: darkred"></RadzenText>
                            </RadzenStack>
                            <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                                <RadzenText Text="@nvl.LoaiNL.Value?.ToString()" Style="font-size: 16px; font-weight: 600; "></RadzenText>
                            </RadzenStack>
                            <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                                <RadzenText Text="@($"{nvl.SoLuongNL.Value?.ToString()}  (pcs)")" Style="font-size: 16px; font-weight: 600;"></RadzenText>
                            </RadzenStack>
                            <RadzenStack Style="width: 19%; height: contain; " AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                                @if (nvl.NgayNhap.Value?.ToString() != string.Empty)
                                {
                                    DateTime ngaynhap = Convert.ToDateTime(nvl.NgayNhap.Value?.ToString());

                                    <RadzenText Text="@ngaynhap.ToString("dd-MM-yyyy")" Style="font-size: 16px; font-weight: 500;"></RadzenText>
                                }
                            </RadzenStack>
                        </RadzenStack>
                    }
                }
            </RadzenStack>
        </RadzenCard>
        <RadzenStack Style="height: 5%; width: 100%; padding: 5px; padding-right: 10px; padding-top: 15px" Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
            <RadzenStack Gap="20px" Style="height: 100%; width: contain;" Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                <RadzenText Text="@("Tổng: " + DSNguyenlieus?.Count)"
                            Style="font-weight: 500; font-size: 18px; color: black; "></RadzenText>
                <RadzenText Text="@($"Tổng số lượng: {DSNguyenlieus?.Sum(nvl => int.Parse(nvl.SoLuongNL.Value?.ToString()?? "0"))} (pcs)")"
                            Style="font-weight: 500; font-size: 18px; color: black; "></RadzenText>
            </RadzenStack>
            
            <RadzenStack Gap="15px" Style="height: 100%; width: contain;" Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center">
                <RadzenButton Style="border-radius: 4px; background-color: darkred" Icon="close" Text="Thoát" Click="@(() => DialogService.Close())"
                              Shade="Shade.Dark" Variant="Variant.Filled" Size="ButtonSize.Small">
                </RadzenButton>
            </RadzenStack>
        </RadzenStack>
    </RadzenStack>
</RadzenCard>

@code {
    [Parameter]
    public SanPham? Sanpham { get; set; }

    [Parameter]
    public List<NguyenLieu>? DSNguyenlieus { get; set; }
}
