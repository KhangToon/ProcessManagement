@page "/khsxmainpage"
@attribute [Authorize(Roles = "Admin, User")]
@* this limited access into page *@

@using ProcessManagement.Commons
@using ProcessManagement.Models
@using ProcessManagement.Models.TienDoGCs
@using ProcessManagement.Pages.KehoachSX.KQGCs
@using ProcessManagement.Pages.KehoachSX.TienDos
@using ProcessManagement.Services.SQLServer
@using Radzen.Blazor
@using Radzen

@inject NotificationService NotificationService
@inject TooltipService TooltipService
@inject ContextMenuService ContextMenuService
@inject DialogService DialogService
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject SQLServerServices SQLServerServices
@inject IJSRuntime JSRuntime

<RadzenRow Gap="0" Style="height: 100%; width: 100%; background-color: white; border-radius: 10px; overflow-y: auto;">
    <RadzenColumn Size="12" SizeMD="12" Style="height: 100%; width: 100%; padding-right: 0">
        <RadzenTabs @ref="tabs" Style="width: 100%; height: 100%; padding-right: 0" @bind-SelectedIndex="@selectedTabIndex">
            <Tabs>
                <RadzenTabsItem>
                    <Template>
                        <RadzenText Text="DANH SÁCH LOT NVL" Style="color: darkred; font-weight: 500; font-size: 15px"></RadzenText>
                    </Template>
                    <ChildContent>
                        <DanhSachLotNVL TargetKHSX="@TargetKHSX"></DanhSachLotNVL>
                    </ChildContent>
                </RadzenTabsItem>

                <RadzenTabsItem>
                    <Template>
                        <RadzenText Text="THEO DÕI SẢN XUẤT" Style="color: darkred; font-weight: 500; font-size: 15px;"></RadzenText>
                    </Template>
                    <ChildContent>
                        <TheoDoiSanXuat TargetKHSX="@TargetKHSX"></TheoDoiSanXuat>
                    </ChildContent>
                </RadzenTabsItem>

                <RadzenTabsItem>
                    <Template>
                        <RadzenText Text="QUẢN LÝ CÔNG ĐOẠN" Style="color: darkred; font-weight: 500; font-size: 15px"></RadzenText>
                    </Template>
                </RadzenTabsItem>
            </Tabs>
        </RadzenTabs>
    </RadzenColumn>
</RadzenRow>

@code {
    [Parameter]
    public object? KHSXID { get; set; }

    RadzenTabs tabs = new RadzenTabs();

    private int selectedTabIndex = 0;

    private KHSX TargetKHSX = new();

    protected override async Task OnInitializedAsync()
    {
        KHSXID = Common.CurrentKHSXid;

        TargetKHSX = SQLServerServices.GetKHSXbyID(KHSXID);

        await base.OnInitializedAsync();
    }
}
